<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta property="og:title" content=" ">
  <meta property="og:description" content=" ">
  <meta property="og:image" content=" ">

  <style>

    html, body {
      margin: 0;
      padding: 0;
      background-color: black;
      height: 100vh;
      overflow: auto;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    svg {
      display: block;
      max-width: 100vw;
      height: 100%;
      width: auto;
    }

    .image-mapper-shape {
      fill: transparent;
      stroke: yellow;
      stroke-width: 2px;
      transform-origin: center center;
      transition: transform 0.3s ease, filter 0.3s ease;
    }
    .image-mapper-shape#red { stroke: red; }
    .image-mapper-shape#blue { stroke: blue; }

    .zoom-part {
      pointer-events: none;
      transition: transform 0.3s ease, filter 0.3s ease, opacity 0.3s ease;
      image-rendering: auto;
    }
  </style>
</head>
<body>
  <svg xmlns="http://www.w3.org/2000/svg"
       xmlns:xlink="http://www.w3.org/1999/xlink"
       viewBox="0 0 2048 2454"
       preserveAspectRatio="xMidYMid meet"
       id="main-svg"> 
    <defs id="clip-defs"></defs>

    <g transform="translate(0,0)" id="main-group">
      <image href="image/1.png" width="1024" height="2454" id="base-image"/>

      <a href="micro/1.pdf"><rect x="368" y="703" width="115" height="380" class="image-mapper-shape"/></a>
      <a href="patho/1.pdf"><rect x="368" y="1083" width="115" height="253.5" class="image-mapper-shape"/></a>
      <a href="patho/q/1.pdf"><rect x="368" y="1339" width="115" height="125" id="red" class="image-mapper-shape"/></a>
      <a href="physio/2.pdf"><rect x="368" y="1465" width="115" height="380" class="image-mapper-shape"/></a>
      <a href="anatomy/1.pdf"><rect x="368" y="1845" width="115" height="380" class="image-mapper-shape"/></a>
      <a href="physio/1.pdf"><rect x="598" y="366" width="114.5" height="315" class="image-mapper-shape"/></a>
      <a href="histo/1.pdf"><rect x="712.35" y="702" width="115" height="380" class="image-mapper-shape"/></a>
      <a href="anatomy/2.pdf"><rect x="712.35" y="1465" width="115" height="380" class="image-mapper-shape"/></a>
      <a href="physio/2.pdf"><rect x="598" y="1846" width="115" height="253.4" class="image-mapper-shape"/></a>
      <a href="physio/q/1.pdf"><rect x="598" y="2100" width="115" height="127" id="red" class="image-mapper-shape"/></a>
    </g>

    <g transform="translate(1024,0)" id="secondary-group">
      <image xlink:href="image/2.png" width="1024" height="2454" id="secondary-image" preserveAspectRatio="xMidYMid meet"/>
      
      <a xlink:href="https://drive.google.com/file/d/1vLk8z7AGqjlJZx1rvL_e7tQa8arC1qud/view?usp=sharing">
      <rect x="137.688139619883" y="477.14605263157887" width="115.00860745614034" height="257.49707602339174" id="blue" class="image-mapper-shape"/>
      </a>
      <a xlink:href="pharma/1.pdf">
      <rect x="137.91991959064327" y="875.84649122807" width="114.8274488304094" height="469.8491228070176" class="image-mapper-shape" data-index="2"></rect>
      </a>
      <a xlink:href="#">
      <rect x="137.72317251461988" y="1827.9460526315788" width="115.11458333333331" height="431.385964912281" class="image-mapper-shape" data-index="3"></rect>
      </a>
      <a xlink:href="#">
      <rect x="367.910745614035" y="1344.915497076024" width="115.7188596491228" height="482.88011695906425" class="image-mapper-shape" data-index="4"></rect>
      </a>
      <a xlink:href="#">
      <rect x="483.5782894736842" y="1104.3466374269003" width="114.13428362573097" height="361.9701754385967" class="image-mapper-shape" data-index="5"></rect>
      </a>
      <a xlink:href="#">
      <rect x="597.5236842105263" y="1465.724707602339" width="114.63859649122799" height="362.65745614035086" class="image-mapper-shape" data-index="6"></rect>
      </a>
      <a xlink:href="#">
      <rect x="711.6490497076023" y="477.07792397660813" width="114.72726608187133" height="377.8353801169589" class="image-mapper-shape" data-index="7"></rect>
      </a>
      <a xlink:href="#">
      <rect x="137.73099415204678" y="348.51929824561404" width="114.48750000000001" height="129.10818713450294" class="image-mapper-shape" data-index="8"></rect>
      </a>
      <a xlink:href="#">
      <rect x="712.5633040935672" y="1345.1815789473683" width="114.0740497076024" height="482.9260233918128" class="image-mapper-shape" data-index="9"></rect>
      </a>
    </g>

    <script>
      const mainSvg = document.getElementById('main-svg');
      const clipDefs = document.getElementById('clip-defs');
      let activeHover = null;

      // ğŸ› ï¸ Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ù€ groups Ø§Ù„Ù„ÙŠ ÙÙŠÙ‡Ø§ ØªØ­ÙˆÙŠÙ„ (ÙƒÙ„ Ø§Ù„Ù€ <g>)
      const groups = document.querySelectorAll('g'); 

      /**
       * ğŸ› ï¸ Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© (X) Ù…Ù† Ø®Ø§ØµÙŠØ© Ø§Ù„Ù€ transform.
       */
      function getTransformX(groupElement) {
          const transformAttr = groupElement.getAttribute('transform');
          if (!transformAttr) return 0;

          // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚ÙŠÙ…Ø© Ø§Ù„Ù€ translate(X, Y)
          // ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù€ regex Ù„ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ù…Ø±ÙˆÙ†Ø© Ù…Ø¹ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø´Ø±ÙŠØ©
          const match = transformAttr.match(/translate\(\s*([\d\.-]+)\s*,/);
          return match ? parseFloat(match[1]) : 0;
      }

      /**
       * ğŸ› ï¸ Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ÙˆØ¬ÙˆØ¯ ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø±ÙˆØ¨ ÙˆØªØ­Ø¯ÙŠØ¯ Ø®ØµØ§Ø¦ØµÙ‡Ø§.
       */
      function getGroupImage(parentGroup) {
          const baseImage = parentGroup.querySelector('image');
          if (!baseImage) return null;

          const IMAGE_SRC = baseImage.getAttribute('href') || baseImage.getAttribute('xlink:href');
          const IMAGE_WIDTH = parseFloat(baseImage.getAttribute('width'));
          const IMAGE_HEIGHT = parseFloat(baseImage.getAttribute('height'));

          // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ØµØ§Ù„Ø­Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹
          if (isNaN(IMAGE_WIDTH) || isNaN(IMAGE_HEIGHT)) return null;

          return { src: IMAGE_SRC, width: IMAGE_WIDTH, height: IMAGE_HEIGHT };
      }


      function attachHover(rect, i) {
        let zoomPart = null;
        let animationId = null;
        const clipPathId = `clip-${i}`;
        const scale = 1.1;
        // Ù†Ø³ØªØ®Ø¯Ù… closest Ø¹Ø´Ø§Ù† Ù„Ùˆ Ø§Ù„Ù€ rect Ø¬ÙˆÙ‡ a ÙˆØ§Ù„Ù€ a Ø¬ÙˆÙ‡ g
        const parentGroup = rect.closest('g'); 

        // ğŸ›‘ Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† ÙÙŠÙ‡ ØµÙˆØ±Ø© ÙÙŠ Ø§Ù„Ø¬Ø±ÙˆØ¨ Ø¹Ø´Ø§Ù† Ø§Ù„ØªØ£Ø«ÙŠØ± ÙŠØ´ØªØºÙ„
        const imageData = getGroupImage(parentGroup);
        if (!imageData) return; 

        const groupOffsetX = getTransformX(parentGroup); // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© Ù„Ù„Ø¬Ø±ÙˆØ¨

        rect.setAttribute('data-index', i);

        // ... Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø§ÙˆØ³ ÙˆØ§Ù„Ù„Ù…Ø³
        rect.addEventListener('mouseover', startHover);
        rect.addEventListener('mouseout', stopHover);
        // ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ø³ÙŠØ·Ø© Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù„Ù…Ø³ (touch)
        rect.addEventListener('touchstart', (e) => {
            if(activeHover && activeHover !== rect) {
                stopHover({target: activeHover});
            }
            if(activeHover === rect) return;
            startHover();
        });
        rect.addEventListener('touchend', stopHover);

        function startHover() {
          if(activeHover === rect) return;
          // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ hover Ù†Ø´Ø· Ø³Ø§Ø¨Ù‚ Ù„Ùˆ ÙƒØ§Ù† Ù…Ø®ØªÙ„Ù
          if (activeHover) {
              const prevRect = activeHover;
              stopHover({target: prevRect});
          }
          activeHover = rect;

          // Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù‡Ù†Ø§ Ù†Ø³Ø¨ÙŠØ© Ù„Ù„Ø¬Ø±ÙˆØ¨
          const x = parseFloat(rect.getAttribute('x'));
          const y = parseFloat(rect.getAttribute('y'));
          const width = parseFloat(rect.getAttribute('width'));
          const height = parseFloat(rect.getAttribute('height'));

          // ğŸ› ï¸ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù…Ø·Ù„Ù‚Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ù€ SVG
          const absoluteX = x + groupOffsetX;
          const absoluteY = y; 

          // 1. Ø¥Ù†Ø´Ø§Ø¡ Clip Path (Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„ÙƒÙ„ÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©)
          let clip = document.createElementNS('http://www.w3.org/2000/svg','clipPath');
          clip.setAttribute('id', clipPathId);
          let clipRect = document.createElementNS('http://www.w3.org/2000/svg','rect');
          clipRect.setAttribute('x', absoluteX);
          clipRect.setAttribute('y', absoluteY);
          clipRect.setAttribute('width', width);
          clipRect.setAttribute('height', height);
          clipDefs.appendChild(clip).appendChild(clipRect);


          // 2. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù…ÙƒØ¨Ø±
          zoomPart = document.createElementNS('http://www.w3.org/2000/svg','image');

          zoomPart.setAttribute('href', imageData.src);
          zoomPart.setAttribute('width', imageData.width);
          zoomPart.setAttribute('height', imageData.height);
          zoomPart.setAttribute('class','zoom-part');
          zoomPart.setAttribute('clip-path', `url(#${clipPathId})`);

          // ğŸ› ï¸ Ø¶Ø¨Ø· Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…ÙƒØ¨Ø±Ø© (ØªØ¨Ø¯Ø£ Ù…Ù† Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¬Ø±ÙˆØ¨ Ø§Ù„Ø£Ø¨ Ø§Ù„Ù…Ø·Ù„Ù‚Ø©)
          zoomPart.setAttribute('x', groupOffsetX); 
          zoomPart.setAttribute('y', 0); 

          // ØªØ­Ø¯ÙŠØ¯ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù„ÙŠÙƒÙˆÙ† Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ù…Ø·Ù„Ù‚
          zoomPart.style.transformOrigin = `${absoluteX + width/2}px ${absoluteY + height/2}px`;
          zoomPart.style.opacity = 0;

          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù…Ø²ÙˆÙ… Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù€ SVG Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
          mainSvg.appendChild(zoomPart);


          // 3. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª
          rect.style.transformOrigin = `${x + width/2}px ${y + height/2}px`; // Ù‡Ù†Ø§ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù†Ø³Ø¨ÙŠØ© Ù„Ù„Ø¬Ø±ÙˆØ¨
          rect.style.transform = `scale(${scale})`;
          zoomPart.style.transform = `scale(${scale})`;
          zoomPart.style.opacity = 1;

          // 4. ØªØ´ØºÙŠÙ„ Ø§Ù„ÙˆÙ‡Ø¬
          let hue = 0;
          animationId = setInterval(() => {
            hue = (hue + 1) % 360;
            const glow = `drop-shadow(0 0 8px hsl(${hue},100%,55%)) drop-shadow(0 0 14px hsl(${(hue+60)%360},100%,60%))`;
            rect.style.filter = glow;
            if(zoomPart) zoomPart.style.filter = glow;
          }, 100);
        }

        function stopHover(e) {
          // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ù Ø³ÙˆØ§Ø¡ ÙƒØ§Ù† Ù‡Ùˆ Ù†ÙØ³Ù‡ Ø£Ùˆ Ø¬ÙˆÙ‡ Ø±Ø§Ø¨Ø·
          const targetRect = e ? (e.target.tagName === 'rect' ? e.target : e.target.closest('a')?.querySelector('.image-mapper-shape')) : rect;

          // Ù„Ùˆ Ø§Ù„Ù‡Ø¯Ù Ù…Ø´ Ù‡Ùˆ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠØŒ Ù†ÙˆÙ‚Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
          if(!targetRect || targetRect !== rect) {
              return; 
          }

          if(animationId) clearInterval(animationId);
          animationId = null; 

          rect.style.transform = 'scale(1)';
          rect.style.filter = 'none';

          if(zoomPart){ zoomPart.remove(); zoomPart = null; }

          const currentClip = document.getElementById(clipPathId);
          if(currentClip) currentClip.remove();

          if(activeHover === rect) {
              activeHover = null;
          }
        }
      }

      // ğŸ› ï¸ Ù†Ø·Ø¨Ù‚ Ø§Ù„Ù€ attachHover Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„Ø§Øª ÙÙŠ ÙƒÙ„ Ø§Ù„Ø¬Ø±ÙˆØ¨Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
      groups.forEach(group => {
          group.querySelectorAll('.image-mapper-shape').forEach((rect, i) => attachHover(rect, i));

          // ğŸ› ï¸ Ù†Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø¬Ø±ÙˆØ¨ Ø¹Ø´Ø§Ù† Ù„Ùˆ Ø£Ø¶ÙŠÙØª Ù…Ø³ØªØ·ÙŠÙ„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
          const observer = new MutationObserver(mutations => {
            mutations.forEach(mutation => {
              mutation.addedNodes.forEach((node, i) => {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù…Ø¶Ø§Ù Ù‡Ùˆ Ø±Ø§Ø¨Ø· ÙˆÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ rect
                if(node.tagName==='A'){
                  const rect = node.querySelector('rect.image-mapper-shape');
                  if(rect) attachHover(rect, Date.now()+i);
                }
              });
            });
          });
          observer.observe(group,{childList:true, subtree:true});
      });

    </script>
</body>
</html>
