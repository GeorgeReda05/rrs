<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© ÙÙˆØ±ÙŠØ©</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background-color: black;
    height: 100vh;
    overflow: auto;
    display: flex;
    justify-content: <!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© ÙÙˆØ±ÙŠØ© Ø¨Ø§Ù„Ù„Ù…Ø³</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background-color: black;
    height: 100vh;
    overflow: auto;
    display: flex;
    justify-content: center;
    align-items: flex-start;
  }

  svg {
    display: block;
    max-width: 100vw;
    height: 100%;
    width: auto;
  }

  .image-mapper-shape {
    fill: transparent;
    stroke: yellow;
    stroke-width: 2px;
    transform-origin: center center;
    transition: none; /* Ø¨Ø¯ÙˆÙ† delay */
  }

  .image-mapper-shape#red { stroke: red; }

  .zoom-part {
    pointer-events: none;
    transition: none; /* Ø¨Ø¯ÙˆÙ† delay */
    image-rendering: auto;
  }
</style>
</head>
<body>

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 2454" preserveAspectRatio="xMidYMid meet">
  <defs id="clip-defs"></defs>

  <g transform="translate(0,0)" id="main-group">
    <image href="image/1.png" width="1024" id="base-image"/>

    <a href="micro/1.pdf" target="_blank"><rect x="368" y="703" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="patho/1.pdf" target="_blank"><rect x="368" y="1083" width="115" height="253.5" class="image-mapper-shape"/></a>
    <a href="patho/q1.pdf" target="_blank"><rect x="368" y="1339" width="115" height="125" id="red" class="image-mapper-shape"/></a>
    <a href="physio/2.pdf" target="_blank"><rect x="368" y="1465" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="anatomy/1.pdf" target="_blank"><rect x="368" y="1845" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="physio/1.pdf" target="_blank"><rect x="598" y="366" width="114.5" height="315" class="image-mapper-shape"/></a>
    <a href="#" target="_blank"><rect x="712.35" y="702" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="#" target="_blank"><rect x="712.35" y="1465" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="physio/2.pdf" target="_blank"><rect x="598" y="1846" width="115" height="380" class="image-mapper-shape"/></a>
  </g>

  <script>
    const mainGroup = document.getElementById('main-group');
    const clipDefs = document.getElementById('clip-defs');
    let activeHover = null;
    const ORIGINAL_IMAGE_HEIGHT = 2454;

    function attachHover(rect, index) {
      let zoomPart = null;
      let clipPathId = `clip-${index}`;
      let animationId = null;
      let touchTimer = null;
      const padding = 5;
      const scale = 1.1;
      const link = rect.parentNode.getAttribute('href');

      rect.addEventListener('mousemove', e => {
        const bbox = rect.getBoundingClientRect();
        const mx = e.clientX - bbox.left;
        const my = e.clientY - bbox.top;
        if(mx < padding || mx > bbox.width - padding || my < padding || my > bbox.height - padding){
          if(activeHover === rect) stopHover();
          return;
        }
        if(activeHover && activeHover !== rect) stopHover();
        if(activeHover === rect) return;
        startHover();
      });

      rect.addEventListener('mouseleave', stopHover);

      // ğŸ“± Ø¯Ø¹Ù… Ø§Ù„Ù„Ù…Ø³ Ø§Ù„ÙÙˆØ±ÙŠ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ delay
      rect.addEventListener('touchstart', e => {
        e.preventDefault();
        if (activeHover && activeHover !== rect) stopHover();
        if (activeHover !== rect) startHover(); // ÙÙˆØ±Ù‹Ø§
      }, { passive: false });

      rect.addEventListener('touchend', e => {
        e.preventDefault();
        stopHover();
        if (link) window.open(link, '_blank'); // ÙŠÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø¹Ø¯ Ø±ÙØ¹ Ø§Ù„Ø¥ØµØ¨Ø¹
      });

      function startHover() {
        activeHover = rect;
        const x = parseFloat(rect.getAttribute('x'));
        const y = parseFloat(rect.getAttribute('y'));
        const width = parseFloat(rect.getAttribute('width'));
        const height = parseFloat(rect.getAttribute('height'));

        let clip = document.createElementNS('http://www.w3.org/2000/svg','clipPath');
        clip.setAttribute('id', clipPathId);
        let clipRect = document.createElementNS('http://www.w3.org/2000/svg','rect');
        clipRect.setAttribute('x', x);
        clipRect.setAttribute('y', y);
        clipRect.setAttribute('width', width);
        clipRect.setAttribute('height', height);
        clip.appendChild(clipRect);
        clipDefs.appendChild(clip);

        zoomPart = document.createElementNS('http://www.w3.org/2000/svg','image');
        zoomPart.setAttribute('href','image/1.png');
        zoomPart.setAttribute('width','1024');
        zoomPart.setAttribute('height', ORIGINAL_IMAGE_HEIGHT);
        zoomPart.setAttribute('class','zoom-part');
        zoomPart.setAttribute('clip-path', `url(#${clipPathId})`);
        zoomPart.style.transformOrigin = `${x + width/2}px ${y + height/2}px`;
        zoomPart.style.opacity = 1;
        mainGroup.appendChild(zoomPart);

        rect.style.transformOrigin = `${x + width/2}px ${y + height/2}px`;
        rect.style.transform = `scale(${scale})`;
        zoomPart.style.transform = `scale(${scale})`;

        let hue = 0;
        animationId = setInterval(() => {
          hue = (hue + 1) % 360;
          const glow = `drop-shadow(0 0 8px hsl(${hue},100%,55%)) drop-shadow(0 0 14px hsl(${(hue+60)%360},100%,60%))`;
          rect.style.filter = glow;
          zoomPart.style.filter = glow;
        }, 100);
      }

      function stopHover() {
        if(!activeHover) return;
        rect.style.transform = 'scale(1)';
        rect.style.filter = 'none';
        if(animationId) clearInterval(animationId);
        if(zoomPart){ zoomPart.remove(); zoomPart = null; }
        const existingClip = document.getElementById(clipPathId);
        if(existingClip) existingClip.remove();
        activeHover = null;
      }
    }

    mainGroup.querySelectorAll('.image-mapper-shape').forEach((rect, i) => attachHover(rect, i));
  </script>
</body>
</html>;
    align-items: flex-start;
  }

  svg {
    display: block;
    max-width: 100vw;
    height: 100%;
    width: auto;
  }

  .image-mapper-shape {
    fill: transparent;
    stroke: yellow;
    stroke-width: 2px;
    transform-origin: center center;
    transition: none; /* â¬…ï¸ Ø£Ù„ØºÙŠÙ†Ø§ Ø£ÙŠ Ø§Ù†ØªÙ‚Ø§Ù„ */
  }

  .image-mapper-shape#red { stroke: red; }

  .zoom-part {
    pointer-events: none;
    transition: none; /* â¬…ï¸ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ delay */
    image-rendering: auto;
  }
</style>
</head>
<body>

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 2454" preserveAspectRatio="xMidYMid meet">
  <defs id="clip-defs"></defs>

  <g transform="translate(0,0)" id="main-group">
    <image href="image/1.png" width="1024" id="base-image"/>

    <a href="micro/1.pdf" target="_blank"><rect x="368" y="703" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="patho/1.pdf" target="_blank"><rect x="368" y="1083" width="115" height="253.5" class="image-mapper-shape"/></a>
    <a href="patho/q1.pdf" target="_blank"><rect x="368" y="1339" width="115" height="125" id="red" class="image-mapper-shape"/></a>
    <a href="physio/2.pdf" target="_blank"><rect x="368" y="1465" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="anatomy/1.pdf" target="_blank"><rect x="368" y="1845" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="physio/1.pdf" target="_blank"><rect x="598" y="366" width="114.5" height="315" class="image-mapper-shape"/></a>
    <a href="#" target="_blank"><rect x="712.35" y="702" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="#" target="_blank"><rect x="712.35" y="1465" width="115" height="380" class="image-mapper-shape"/></a>
    <a href="physio/2.pdf" target="_blank"><rect x="598" y="1846" width="115" height="380" class="image-mapper-shape"/></a>
  </g>

  <script>
    const mainGroup = document.getElementById('main-group');
    const clipDefs = document.getElementById('clip-defs');
    let activeHover = null;
    const ORIGINAL_IMAGE_HEIGHT = 2454;

    function attachHover(rect, index) {
      let zoomPart = null;
      let clipPathId = `clip-${index}`;
      let animationId = null;
      const padding = 5;
      const scale = 1.1;

      rect.addEventListener('mousemove', e => {
        const bbox = rect.getBoundingClientRect();
        const mx = e.clientX - bbox.left;
        const my = e.clientY - bbox.top;
        if(mx < padding || mx > bbox.width - padding || my < padding || my > bbox.height - padding){
          if(activeHover === rect) stopHover();
          return;
        }
        if(activeHover && activeHover !== rect) stopHover();
        if(activeHover === rect) return;
        startHover();
      });

      rect.addEventListener('mouseleave', stopHover);

      function startHover() {
        activeHover = rect;
        const x = parseFloat(rect.getAttribute('x'));
        const y = parseFloat(rect.getAttribute('y'));
        const width = parseFloat(rect.getAttribute('width'));
        const height = parseFloat(rect.getAttribute('height'));

        let clip = document.createElementNS('http://www.w3.org/2000/svg','clipPath');
        clip.setAttribute('id', clipPathId);
        let clipRect = document.createElementNS('http://www.w3.org/2000/svg','rect');
        clipRect.setAttribute('x', x);
        clipRect.setAttribute('y', y);
        clipRect.setAttribute('width', width);
        clipRect.setAttribute('height', height);
        clip.appendChild(clipRect);
        clipDefs.appendChild(clip);

        zoomPart = document.createElementNS('http://www.w3.org/2000/svg','image');
        zoomPart.setAttribute('href','image/1.png');
        zoomPart.setAttribute('width','1024');
        zoomPart.setAttribute('height', ORIGINAL_IMAGE_HEIGHT);
        zoomPart.setAttribute('class','zoom-part');
        zoomPart.setAttribute('clip-path', `url(#${clipPathId})`);
        zoomPart.style.transformOrigin = `${x + width/2}px ${y + height/2}px`;
        zoomPart.style.opacity = 1;
        mainGroup.appendChild(zoomPart);

        rect.style.transformOrigin = `${x + width/2}px ${y + height/2}px`;
        rect.style.transform = `scale(${scale})`;
        zoomPart.style.transform = `scale(${scale})`;

        let hue = 0;
        animationId = setInterval(() => {
          hue = (hue + 1) % 360;
          const glow = `drop-shadow(0 0 8px hsl(${hue},100%,55%)) drop-shadow(0 0 14px hsl(${(hue+60)%360},100%,60%))`;
          rect.style.filter = glow;
          zoomPart.style.filter = glow;
        }, 100);
      }

      function stopHover() {
        if(!activeHover) return;
        rect.style.transform = 'scale(1)';
        rect.style.filter = 'none';
        if(animationId) clearInterval(animationId);
        if(zoomPart){ zoomPart.remove(); zoomPart = null; }
        const existingClip = document.getElementById(clipPathId);
        if(existingClip) existingClip.remove();
        activeHover = null;
      }
    }

    mainGroup.querySelectorAll('.image-mapper-shape').forEach((rect, i) => attachHover(rect, i));

    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        mutation.addedNodes.forEach((node, i) => {
          if(node.tagName==='A'){
            const rect = node.querySelector('rect.image-mapper-shape');
            if(rect) attachHover(rect, Date.now()+i);
          }
        });
      });
    });
    observer.observe(mainGroup,{childList:true, subtree:true});
  </script>
</body>
</html>